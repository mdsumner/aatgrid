get_map <- memoise::memoize(function(ex, crs = NULL) {
  src <- sds::CGAZ()
  if (!is.numeric(ex)) {
    ex <- try(as.vector(terra::ext(terra::project(terra::ext(ex), to = "EPSG:4326", from = terra::crs(ex)))))
    if (inherits(ex, "try-error")) stop("cannot get a sane longlat extent from input")
  }
  x <-  terra::crop(terra::vect(src, extent = terra::ext(ex)), terra::ext(ex))
  if (nrow(x) < 1) {
    res <- diff(ex)[c(1)]/512
    r <- terra::rast(terra::ext(ex), res = res, crs = "EPSG:4326")
    r <- terra::project(terra::rast(sds::gebco()), r, by_util = TRUE)
    x <- terra::as.contour(r)
  }
  if (!is.null(crs)) {
    x <- terra::project(x, crs)
  }

  x
})

myic_traverse <- function(){
  structure(list(V2 = c(123.54714, 122.71876, 121.857417, 121.118274,
                        120.4613, 120, 119.417284, 118.882564, 118.37672, 117.907536,
                        117.46929, 117.230209, 117, 116.73274, 116.343332, 115.97585,
                        115.621913, 115.32762, 115.118676, 114.91112, 114.533316, 114.15059,
                        113.756781, 113.37421, 112.98903, 112.52737, 112.44797, 112.56103,
                        112.59963, 112.66973, 112.58322, 112.5044, 112.30904, 112.32893,
                        112.1496, 112.10554, 112.15594, 112.23682, 112.261389, 112.314167,
                        112.403611, 112.481944, 112.568889, 112.626389, 112.663333, 112.695278,
                        112.718333, 112.736111, 112.753333, 112.58085, 112.394217, 112.2773,
                        112.189183, 112.186967, 112.15405, 112.1309, 112.079517, 112.010917,
                        111.9539, 111.90705, 111.846167, 111.7737, 111.661433, 111.575133,
                        111.4931, 111.401433, 111.332367, 111.2711, 111.174433, 111.087667,
                        110.9982, 110.92255, 110.862333, 110.69385), V1 = c(-75.04052,
                                                                            -75.02224, -75, -74.664941, -74.3525, -74.113552, -73.8, -73.5,
                                                                            -73.204791, -72.9, -72.604444, -72.367094, -72.132269, -71.851598,
                                                                            -71.515478, -71.186321, -71, -70.841828, -70.525837, -70.201625,
                                                                            -70, -69.790859, -69.56738, -69.344835, -69.200473, -68.972045,
                                                                            -68.749804, -68.637798, -68.443457, -68.35305, -68.3087, -68.228798,
                                                                            -68.093047, -67.891446, -67.754854, -67.676546, -67.61906, -67.558742,
                                                                            -67.393889, -67.329444, -67.29, -67.223056, -67.146389, -67.084722,
                                                                            -67.047222, -67.014722, -66.969167, -66.933611, -66.899167, -66.769533,
                                                                            -66.595983, -66.55945, -66.532533, -66.531933, -66.521667, -66.51435,
                                                                            -66.498667, -66.4771, -66.459267, -66.455683, -66.449683, -66.440533,
                                                                            -66.424717, -66.412533, -66.400983, -66.388017, -66.378317, -66.3696,
                                                                            -66.356283, -66.344217, -66.331567, -66.320933, -66.312317, -66.285867
                        )), class = "data.frame", row.names = c(NA, -74L))
}
